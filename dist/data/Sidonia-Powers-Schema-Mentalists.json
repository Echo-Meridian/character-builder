{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Sidonia Mentalist Powers Schema",
  "description": "A schema to validate the structure of Mentalist archetypes, including foundational augments, paths, and the anomalous Meta-Mind.",
  "type": "object",
  "properties": {
    "mentalist_archetypes": {
      "type": "object",
      "properties": {
        "foundational_augments": {
          "type": "object",
          "properties": {
            "polarity": {
              "type": "array",
              "items": { "$ref": "#/$defs/foundationalAugmentObject" }
            },
            "scope": {
              "type": "array",
              "items": { "$ref": "#/$defs/foundationalAugmentObject" }
            }
          },
          "required": ["polarity", "scope"]
        },
        "empath": { "$ref": "#/$defs/standardMentalistPathObject" },
        "mesmer": { "$ref": "#/$defs/standardMentalistPathObject" },
        "siren": { "$ref": "#/$defs/standardMentalistPathObject" },
        "dreamer": { "$ref": "#/$defs/standardMentalistPathObject" },
        "meta-mind": { "$ref": "#/$defs/metaMindPathObject" }
      },
      "required": ["foundational_augments", "empath", "mesmer", "siren", "dreamer", "meta-mind"]
    },
    "trauma_mutations": {
      "type": "object",
      "properties": {
        "empath": { "type": "array", "items": { "$ref": "#/$defs/traumaMutationObject" } },
        "mesmer": { "type": "array", "items": { "$ref": "#/$defs/traumaMutationObject" } },
        "siren": { "type": "array", "items": { "$ref": "#/$defs/traumaMutationObject" } },
        "dreamer": { "type": "array", "items": { "$ref": "#/$defs/traumaMutationObject" } },
        "meta-mind": { "type": "array", "items": { "$ref": "#/$defs/traumaMutationObject" } }
      },
      "required": ["empath", "mesmer", "siren", "dreamer", "meta-mind"]
    }
  },
  "required": ["mentalist_archetypes", "trauma_mutations"],
  "$defs": {
    "abilityObject": {
      "type": "object",
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "type": { "type": "string", "enum": ["move", "augment"] },
        "description": { "type": "string" },
        "cost": { "type": "string" }
      },
      "required": ["id", "name", "type", "description"]
    },
    "metaMindAbilityObject": {
      "type": "object",
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "type": { "type": "string", "enum": ["move", "augment"] },
        "duration": { "type": "string" },
        "scope": { "type": "string" },
        "description": { "type": "string" },
        "cost": { "type": "string" }
      },
      "required": ["id", "name", "type", "duration", "scope", "description"]
    },
    "foundationalAugmentObject": {
      "type": "object",
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "description": { "type": "string" },
        "cost": { "type": "string" }
      },
      "required": ["id", "name", "description", "cost"]
    },
    "consequenceObject": {
        "type": "object",
        "properties": {
            "roll": { "type": "integer" },
            "result": { "type": "string" }
        },
        "required": ["roll", "result"]
    },
    "traumaMutationObject": {
        "type": "object",
        "properties": {
            "id": { "type": "string" },
            "name": { "type": "string" },
            "prerequisite": { "type": "string" },
            "cost": { "type": "string" },
            "effect": { "type": "string" }
        },
        "required": ["id", "name", "prerequisite", "cost", "effect"]
    },
    "standardMentalistPathObject": {
      "type": "object",
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "philosophy": { "type": "string" },
        "natural_lean": { "type": "string" },
        "power_selections": {
          "type": "object",
          "additionalProperties": {
            "oneOf": [
              { "$ref": "#/$defs/abilityObject" },
              { "type": "array", "items": { "$ref": "#/$defs/abilityObject" } }
            ]
          }
        }
      },
      "required": ["id", "name", "philosophy", "natural_lean", "power_selections"]
    },
    "metaMindPathObject": {
      "type": "object",
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "philosophy": { "type": "string" },
        "natural_lean": { "type": "string" },
        "core_mechanics": {
          "type": "object",
          "properties": {
            "standard_moves": { "type": "object" },
            "deep_surgery": { "type": "object" }
          },
          "required": ["standard_moves", "deep_surgery"]
        },
        "consequence_tables": {
          "type": "object",
          "properties": {
            "neural_glitch_table": { "type": "array", "items": { "$ref": "#/$defs/consequenceObject"} },
            "psychic_catastrophe_table": { "type": "array", "items": { "$ref": "#/$defs/consequenceObject"} }
          },
          "required": ["neural_glitch_table", "psychic_catastrophe_table"]
        },
        "powers": {
          "type": "array",
          "items": { "$ref": "#/$defs/metaMindAbilityObject" }
        }
      },
      "required": ["id", "name", "philosophy", "core_mechanics", "consequence_tables", "powers"]
    }
  }
}

